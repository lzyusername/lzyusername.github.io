<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人格测试 - 探索真实的自己</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- GSAP 动画库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- html2canvas 库用于图片保存 -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        accent: '#ec4899',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        info: '#3b82f6',
                        dark: '#1e293b',
                        light: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'slide-down': 'slideDown 0.5s ease-out',
                        'slide-left': 'slideLeft 0.5s ease-out',
                        'slide-right': 'slideRight 0.5s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(-20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        slideLeft: {
                            '0%': { transform: 'translateX(20px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                        slideRight: {
                            '0%': { transform: 'translateX(-20px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                    },
                    boxShadow: {
                        'android': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'android-elevated': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .android-status-bar {
                height: 24px;
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            }
            .android-nav-bar {
                height: 48px;
                background: #f8fafc;
                border-top: 1px solid #e2e8f0;
            }
            .android-card {
                border-radius: 12px;
                background: white;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                transition: all 0.3s ease;
            }
            .android-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            }
            .gradient-bg {
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
            }
            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-image: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            }
            .progress-bar {
                height: 8px;
                border-radius: 4px;
                background: #e2e8f0;
                overflow: hidden;
            }
            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
                transition: width 0.3s ease;
            }
            .radio-button {
                appearance: none;
                width: 20px;
                height: 20px;
                border: 2px solid #cbd5e1;
                border-radius: 50%;
                position: relative;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .radio-button:checked {
                border-color: #6366f1;
                background: #6366f1;
            }
            .radio-button:checked::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: white;
            }
            .option-card {
                transition: all 0.2s ease;
                cursor: pointer;
            }
            .option-card:hover {
                background: #f8fafc;
            }
            .option-card.selected {
                background: #eff6ff;
                border-color: #6366f1;
            }
            .share-card {
                position: relative;
                overflow: hidden;
            }
            .share-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
                z-index: -1;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- 安卓状态栏 -->
    <div class="android-status-bar fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-4">
        <div class="text-white text-xs font-medium">20:30</div>
        <div class="flex items-center space-x-1">
            <i class="fa fa-signal text-white text-xs"></i>
            <i class="fa fa-wifi text-white text-xs"></i>
            <i class="fa fa-battery-three-quarters text-white text-xs"></i>
        </div>
    </div>

    <!-- 主容器 -->
    <div class="pt-6 pb-12 min-h-screen">
        <!-- 页面内容 -->
        <div id="app" class="container mx-auto px-4">
            <!-- 首页 -->
            <div id="home-page" class="animate-fade-in">
                <!-- 顶部标题 -->
                <div class="text-center py-6">
                    <h1 class="text-3xl font-bold text-gradient">人格测试</h1>
                    <p class="text-gray-600 mt-2">探索真实的自己，发现无限可能</p>
                </div>

                <!-- 测试类型选择 -->
                <div class="space-y-4 mt-6">
                    <div class="android-card p-6 animate-slide-up" data-test-type="mbti">
                        <div class="flex items-start">
                            <div class="w-12 h-12 rounded-full gradient-bg flex items-center justify-center flex-shrink-0">
                                <i class="fa fa-user-circle text-white text-xl"></i>
                            </div>
                            <div class="ml-4 flex-grow">
                                <h3 class="text-xl font-semibold text-gray-800">MBTI人格测试</h3>
                                <p class="text-gray-600 mt-1">探索你的16型人格，了解你的思维方式和行为偏好</p>
                                <div class="flex items-center mt-2 text-sm text-gray-500">
                                    <span><i class="fa fa-clock-o mr-1"></i> 约10分钟</span>
                                    <span class="mx-3">•</span>
                                    <span><i class="fa fa-question-circle mr-1"></i> 28题</span>
                                </div>
                            </div>
                            <i class="fa fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>

                    <div class="android-card p-6 animate-slide-up" style="animation-delay: 0.1s;" data-test-type="big5">
                        <div class="flex items-start">
                            <div class="w-12 h-12 rounded-full gradient-bg flex items-center justify-center flex-shrink-0">
                                <i class="fa fa-star text-white text-xl"></i>
                            </div>
                            <div class="ml-4 flex-grow">
                                <h3 class="text-xl font-semibold text-gray-800">大五人格测试</h3>
                                <p class="text-gray-600 mt-1">从五个维度全面分析你的性格特质和行为倾向</p>
                                <div class="flex items-center mt-2 text-sm text-gray-500">
                                    <span><i class="fa fa-clock-o mr-1"></i> 约15分钟</span>
                                    <span class="mx-3">•</span>
                                    <span><i class="fa fa-question-circle mr-1"></i> 50题</span>
                                </div>
                            </div>
                            <i class="fa fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>

                    <div class="android-card p-6 animate-slide-up" style="animation-delay: 0.2s;" data-test-type="enneagram">
                        <div class="flex items-start">
                            <div class="w-12 h-12 rounded-full gradient-bg flex items-center justify-center flex-shrink-0">
                                <i class="fa fa-heart text-white text-xl"></i>
                            </div>
                            <div class="ml-4 flex-grow">
                                <h3 class="text-xl font-semibold text-gray-800">九型人格测试</h3>
                                <p class="text-gray-600 mt-1">发现你的核心动机和价值观，实现个人成长</p>
                                <div class="flex items-center mt-2 text-sm text-gray-500">
                                    <span><i class="fa fa-clock-o mr-1"></i> 约20分钟</span>
                                    <span class="mx-3">•</span>
                                    <span><i class="fa fa-question-circle mr-1"></i> 90题</span>
                                </div>
                            </div>
                            <i class="fa fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>
                </div>

                <!-- 历史记录 -->
                <div class="mt-8">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">测试历史</h2>
                        <button id="clear-history" class="text-sm text-primary">
                            <i class="fa fa-trash-o mr-1"></i> 清空
                        </button>
                    </div>
                    <div id="history-list" class="space-y-3">
                        <!-- 历史记录将通过JS动态添加 -->
                        <div class="text-center text-gray-500 py-8">
                            <i class="fa fa-history text-4xl mb-3"></i>
                            <p>还没有测试记录</p>
                            <p class="text-sm mt-1">完成测试后，结果将显示在这里</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 测试说明页 -->
            <div id="instructions-page" class="hidden animate-fade-in">
                <div class="flex items-center mb-6">
                    <button class="back-btn mr-4 text-gray-600">
                        <i class="fa fa-arrow-left text-xl"></i>
                    </button>
                    <h1 class="text-2xl font-bold text-gray-800 flex-grow">测试说明</h1>
                </div>
                
                <div class="android-card p-6">
                    <h2 id="test-title" class="text-xl font-semibold text-gray-800 mb-4"></h2>
                    <p id="test-description" class="text-gray-600 mb-6"></p>
                    
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center flex-shrink-0">1</div>
                            <div class="ml-3">
                                <h3 class="font-medium text-gray-800">如实回答</h3>
                                <p class="text-sm text-gray-600">请根据真实的自己选择答案，而非你希望成为的样子</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center flex-shrink-0">2</div>
                            <div class="ml-3">
                                <h3 class="font-medium text-gray-800">第一直觉</h3>
                                <p class="text-sm text-gray-600">无需过度思考，凭第一感觉选择最符合的选项</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center flex-shrink-0">3</div>
                            <div class="ml-3">
                                <h3 class="font-medium text-gray-800">保持专注</h3>
                                <p class="text-sm text-gray-600">选择一个安静的环境，确保测试过程不被打扰</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center flex-shrink-0">4</div>
                            <div class="ml-3">
                                <h3 class="font-medium text-gray-800">完整作答</h3>
                                <p class="text-sm text-gray-600">请回答所有问题，以获得最准确的测试结果</p>
                            </div>
                        </div>
                    </div>
                    
                    <button id="start-test-btn" class="w-full py-3 mt-8 rounded-lg gradient-bg text-white font-medium text-lg">
                        开始测试
                    </button>
                </div>
            </div>

            <!-- 测试页面 -->
            <div id="test-page" class="hidden animate-fade-in">
                <!-- 顶部导航 -->
                <div class="flex items-center justify-between mb-4">
                    <button class="back-btn text-gray-600">
                        <i class="fa fa-arrow-left text-xl"></i>
                    </button>
                    <div class="text-center flex-grow">
                        <span id="current-question-number" class="text-lg font-medium text-gray-800"></span>
                        <span class="text-gray-500"> / </span>
                        <span id="total-questions" class="text-gray-500"></span>
                    </div>
                    <button id="exit-test-btn" class="text-gray-600">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>

                <!-- 进度条 -->
                <div class="progress-bar mb-6">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>

                <!-- 题目内容 -->
                <div class="android-card p-6 mb-6">
                    <h2 id="question-text" class="text-xl font-medium text-gray-800 mb-6"></h2>
                    
                    <div id="options-container" class="space-y-3">
                        <!-- 选项将通过JS动态添加 -->
                    </div>
                </div>

                <!-- 底部按钮 -->
                <div class="flex space-x-4">
                    <button id="prev-question-btn" class="flex-1 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                        上一题
                    </button>
                    <button id="next-question-btn" class="flex-1 py-3 rounded-lg gradient-bg text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                        下一题
                    </button>
                </div>
            </div>

            <!-- 结果页面 -->
            <div id="result-page" class="hidden animate-fade-in">
                <!-- 顶部导航 -->
                <div class="flex items-center justify-between mb-6">
                    <button class="back-to-home-btn text-gray-600">
                        <i class="fa fa-home text-xl"></i>
                    </button>
                    <h1 class="text-2xl font-bold text-gradient flex-grow text-center">测试结果</h1>
                    <button id="share-result-btn" class="text-gray-600">
                        <i class="fa fa-share-alt text-xl"></i>
                    </button>
                </div>

                <!-- 结果卡片 -->
                <div class="android-card p-6 mb-6">
                    <div class="text-center mb-6">
                        <h2 id="result-title" class="text-2xl font-bold text-gray-800"></h2>
                        <p id="result-subtitle" class="text-gray-600 mt-2"></p>
                    </div>

                    <!-- 图表容器 -->
                    <div id="result-chart-container" class="mb-8">
                        <canvas id="result-chart"></canvas>
                    </div>

                    <!-- 性格描述 -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">性格概述</h3>
                        <p id="personality-description" class="text-gray-600 leading-relaxed"></p>
                    </div>

                    <!-- 优势与劣势 -->
                    <div class="grid grid-cols-2 gap-6 mb-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                                <i class="fa fa-check-circle text-success mr-2"></i> 优势
                            </h3>
                            <ul id="strengths-list" class="space-y-2 text-gray-600">
                                <!-- 优势将通过JS动态添加 -->
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                                <i class="fa fa-exclamation-triangle text-warning mr-2"></i> 待提升
                            </h3>
                            <ul id="weaknesses-list" class="space-y-2 text-gray-600">
                                <!-- 劣势将通过JS动态添加 -->
                            </ul>
                        </div>
                    </div>

                    <!-- 适合职业 -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-briefcase text-primary mr-2"></i> 适合职业
                        </h3>
                        <div id="careers-container" class="flex flex-wrap gap-2">
                            <!-- 职业标签将通过JS动态添加 -->
                        </div>
                    </div>

                    <!-- 成长建议 -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-lightbulb-o text-warning mr-2"></i> 成长建议
                        </h3>
                        <ul id="growth-tips" class="space-y-2 text-gray-600 list-disc list-inside">
                            <!-- 建议将通过JS动态添加 -->
                        </ul>
                    </div>
                </div>

                <!-- 操作按钮 -->
                <div class="flex space-x-4">
                    <button id="save-result-btn" class="flex-1 py-3 rounded-lg border border-primary text-primary font-medium">
                        <i class="fa fa-download mr-2"></i> 保存结果
                    </button>
                    <button id="take-another-test-btn" class="flex-1 py-3 rounded-lg gradient-bg text-white font-medium">
                        再测一次
                    </button>
                </div>
            </div>

            <!-- 分享弹窗 -->
            <div id="share-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
                <div class="bg-white rounded-xl w-5/6 max-w-md animate-slide-up">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800">分享测试结果</h3>
                            <button id="close-share-modal" class="text-gray-400">
                                <i class="fa fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div id="share-card-preview" class="share-card p-4 rounded-lg mb-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gradient mb-2" id="share-title"></div>
                                <div class="text-gray-600 mb-4" id="share-subtitle"></div>
                                <div class="w-full h-40 mb-4">
                                    <canvas id="share-chart"></canvas>
                                </div>
                                <div class="text-sm text-gray-500">
                                    来自「人格测试」App
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-4 gap-4">
                            <button class="flex flex-col items-center">
                                <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white mb-2">
                                    <i class="fa fa-wechat text-xl"></i>
                                </div>
                                <span class="text-xs text-gray-600">微信</span>
                            </button>
                            <button class="flex flex-col items-center">
                                <div class="w-12 h-12 rounded-full bg-blue-400 flex items-center justify-center text-white mb-2">
                                    <i class="fa fa-qq text-xl"></i>
                                </div>
                                <span class="text-xs text-gray-600">QQ</span>
                            </button>
                            <button class="flex flex-col items-center">
                                <div class="w-12 h-12 rounded-full bg-red-500 flex items-center justify-center text-white mb-2">
                                    <i class="fa fa-weibo text-xl"></i>
                                </div>
                                <span class="text-xs text-gray-600">微博</span>
                            </button>
                            <button id="save-image-btn" class="flex flex-col items-center">
                                <div class="w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-white mb-2">
                                    <i class="fa fa-download text-xl"></i>
                                </div>
                                <span class="text-xs text-gray-600">保存</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 安卓导航栏 -->
    <div class="android-nav-bar fixed bottom-0 left-0 right-0 z-40 flex items-center justify-around">
        <button class="flex flex-col items-center justify-center text-primary">
            <i class="fa fa-home text-xl"></i>
            <span class="text-xs mt-1">首页</span>
        </button>
        <button class="flex flex-col items-center justify-center text-gray-500">
            <i class="fa fa-search text-xl"></i>
            <span class="text-xs mt-1">发现</span>
        </button>
        <button class="flex flex-col items-center justify-center text-gray-500">
            <i class="fa fa-user text-xl"></i>
            <span class="text-xs mt-1">我的</span>
        </button>
    </div>

    <script>
        // 测试数据
        const testData = {
            mbti: {
                name: "MBTI人格测试",
                description: "MBTI（迈尔斯-布里格斯类型指标）是一种基于荣格心理学理论的人格测试工具，通过测量四个维度来确定你的人格类型：外向(E)-内向(I)、感觉(S)-直觉(N)、思考(T)-情感(F)、判断(J)-感知(P)。",
                questions: [
                    {
                        id: 1,
                        text: "在社交场合中，你更倾向于：",
                        dimension: "EI",
                        options: [
                            { text: "主动与他人交流，享受社交活动", score: "E" },
                            { text: "等待他人来接近你，喜欢安静的环境", score: "I" }
                        ]
                    },
                    {
                        id: 2,
                        text: "当面对新问题时，你更注重：",
                        dimension: "SN",
                        options: [
                            { text: "具体的事实和数据", score: "S" },
                            { text: "可能性和潜在意义", score: "N" }
                        ]
                    },
                    {
                        id: 3,
                        text: "做决定时，你更依赖：",
                        dimension: "TF",
                        options: [
                            { text: "逻辑分析和客观事实", score: "T" },
                            { text: "个人价值观和他人感受", score: "F" }
                        ]
                    },
                    {
                        id: 4,
                        text: "你更喜欢的生活方式是：",
                        dimension: "JP",
                        options: [
                            { text: "有计划、有组织的", score: "J" },
                            { text: "灵活、即兴的", score: "P" }
                        ]
                    },
                    {
                        id: 5,
                        text: "在团队中，你更倾向于：",
                        dimension: "EI",
                        options: [
                            { text: "表达自己的想法，引导讨论", score: "E" },
                            { text: "倾听他人意见，在需要时发言", score: "I" }
                        ]
                    },
                    {
                        id: 6,
                        text: "你如何看待过去的经验？",
                        dimension: "SN",
                        options: [
                            { text: "它们是可靠的指导，应该重视", score: "S" },
                            { text: "它们可能限制创新，需要突破", score: "N" }
                        ]
                    },
                    {
                        id: 7,
                        text: "当朋友遇到困难时，你会：",
                        dimension: "TF",
                        options: [
                            { text: "帮助分析问题，提供解决方案", score: "T" },
                            { text: "倾听并提供情感支持", score: "F" }
                        ]
                    },
                    {
                        id: 8,
                        text: "对于最后期限，你通常会：",
                        dimension: "JP",
                        options: [
                            { text: "提前完成任务，避免压力", score: "J" },
                            { text: "在压力下工作更有效率", score: "P" }
                        ]
                    },
                    {
                        id: 9,
                        text: "你更喜欢的工作环境是：",
                        dimension: "EI",
                        options: [
                            { text: "充满活力和互动的开放空间", score: "E" },
                            { text: "安静、专注的独立工作空间", score: "I" }
                        ]
                    },
                    {
                        id: 10,
                        text: "学习新技能时，你更关注：",
                        dimension: "SN",
                        options: [
                            { text: "实用的步骤和具体的应用", score: "S" },
                            { text: "概念框架和理论基础", score: "N" }
                        ]
                    },
                    {
                        id: 11,
                        text: "在冲突中，你倾向于：",
                        dimension: "TF",
                        options: [
                            { text: "直接面对问题，寻求解决方案", score: "T" },
                            { text: "优先考虑关系和谐，避免冲突", score: "F" }
                        ]
                    },
                    {
                        id: 12,
                        text: "你的周末计划通常是：",
                        dimension: "JP",
                        options: [
                            { text: "提前安排好各项活动", score: "J" },
                            { text: "随心情和机会灵活决定", score: "P" }
                        ]
                    },
                    {
                        id: 13,
                        text: "你如何处理大量信息？",
                        dimension: "SN",
                        options: [
                            { text: "关注细节，逐步处理", score: "S" },
                            { text: "寻找模式和整体趋势", score: "N" }
                        ]
                    },
                    {
                        id: 14,
                        text: "在做重要决定时，你会：",
                        dimension: "TF",
                        options: [
                            { text: "权衡利弊，理性分析", score: "T" },
                            { text: "考虑对他人的影响和自己的价值观", score: "F" }
                        ]
                    }
                ],
                results: {
                    "ESTJ": {
                        name: "总经理型",
                        subtitle: "务实、有序、负责任的组织者",
                        description: "ESTJ型人格注重实际、逻辑和效率。他们是天生的组织者和领导者，善于制定计划并确保任务完成。他们重视传统和规则，相信明确的结构和秩序。在团队中，他们可靠、负责任，能够带领团队朝着共同的目标前进。",
                        strengths: ["组织能力强", "负责任", "务实高效", "善于规划", "可靠稳定"],
                        weaknesses: ["过于严格", "缺乏灵活性", "对变化抵抗", "忽视情感需求", "过于直接"],
                        careers: ["企业管理", "项目管理", "法律", "教育管理", "军事", "财务"],
                        growthTips: [
                            "学会接受不同的观点和方法",
                            "更加关注团队成员的情感需求",
                            "培养对变化的适应能力",
                            "在坚持原则的同时保持灵活性",
                            "学会倾听和理解他人的想法"
                        ]
                    },
                    "ENTJ": {
                        name: "指挥官型",
                        subtitle: "有远见、果断、战略性的领导者",
                        description: "ENTJ型人格是天生的领导者，具有强烈的愿景和战略思维。他们自信、果断，善于分析复杂问题并制定解决方案。他们重视效率和结果，能够激励团队实现宏伟目标。在商业和组织环境中，他们常常担任高层管理职位，推动变革和创新。",
                        strengths: ["战略思维", "领导力强", "果断决策", "目标导向", "创新能力"],
                        weaknesses: ["过于强势", "缺乏耐心", "忽视细节", "对他人要求过高", "情感表达不足"],
                        careers: ["企业高管", "战略咨询", "创业家", "政治领袖", "法律", "工程管理"],
                        growthTips: [
                            "学会耐心倾听他人意见",
                            "更加关注执行细节",
                            "培养对团队成员的同理心",
                            "学会赞赏和认可他人的贡献",
                            "在追求目标的同时保持灵活性"
                        ]
                    },
                    "ESFJ": {
                        name: "领事型",
                        subtitle: "热情、友善、乐于助人的照顾者",
                        description: "ESFJ型人格热情、友善，善于照顾他人的需求。他们重视和谐的人际关系，乐于为他人提供帮助和支持。他们注重传统和社会规范，是社区和家庭的中坚力量。在工作中，他们善于团队合作，能够创造温暖、和谐的工作环境。",
                        strengths: ["热情友善", "乐于助人", "善于照顾他人", "团队合作", "注重细节"],
                        weaknesses: ["过度牺牲自我", "难以拒绝他人", "对批评敏感", "缺乏主见", "过度关注他人看法"],
                        careers: ["教育", "医疗护理", "社会工作", "客户服务", "人力资源", "酒店管理"],
                        growthTips: [
                            "学会关注自己的需求",
                            "培养独立思考的能力",
                            "提高对批评的承受能力",
                            "建立健康的边界",
                            "发展自我价值感"
                        ]
                    },
                    "ENFJ": {
                        name: "教导型",
                        subtitle: "富有魅力、鼓舞人心的理想主义者",
                        description: "ENFJ型人格富有魅力和感染力，善于理解和激励他人。他们具有强烈的理想主义和社会责任感，致力于帮助他人实现潜能。他们善于沟通和建立关系，能够创造和谐的团队氛围。在领导岗位上，他们注重团队成员的个人成长和发展。",
                        strengths: ["感染力强", "善于激励", "富有同理心", "优秀的沟通者", "理想主义"],
                        weaknesses: ["过度理想化", "难以面对冲突", "情感消耗过大", "对批评敏感", "过度承诺"],
                        careers: ["教育", "心理咨询", "公共关系", "市场营销", "社会工作", "培训师"],
                        growthTips: [
                            "学会面对和处理冲突",
                            "建立健康的情感边界",
                            "提高现实感和客观性",
                            "学会合理安排时间和精力",
                            "培养接受批评的能力"
                        ]
                    },
                    "ISTJ": {
                        name: "检查员型",
                        subtitle: "可靠、细致、注重实际的守护者",
                        description: "ISTJ型人格可靠、务实，注重细节和准确性。他们尊重传统和规则，善于遵循既定程序完成任务。他们具有强烈的责任感和职业道德，是组织中稳定的中坚力量。在工作中，他们严谨细致，能够确保任务高质量完成。",
                        strengths: ["可靠稳定", "注重细节", "严谨细致", "负责任", "务实高效"],
                        weaknesses: ["过于保守", "难以适应变化", "对新想法持怀疑态度", "情感表达不足", "过度工作"],
                        careers: ["会计", "法律", "工程", "信息技术", "质量控制", "项目管理"],
                        growthTips: [
                            "培养对新想法的开放态度",
                            "提高适应变化的能力",
                            "学习表达情感和赞赏",
                            "平衡工作和生活",
                            "发展创新思维"
                        ]
                    },
                    "INTJ": {
                        name: "建筑师型",
                        subtitle: "独立、理性、具有战略思维的规划者",
                        description: "INTJ型人格是独立、理性的思考者，具有卓越的战略思维和问题解决能力。他们善于分析复杂系统，寻找改进和创新的机会。他们具有强烈的自主性和意志力，能够坚持自己的愿景并实现目标。在专业领域，他们常常成为专家和创新者。",
                        strengths: ["战略思维", "创新能力", "独立思考", "解决复杂问题", "目标导向"],
                        weaknesses: ["过于理性", "缺乏耐心", "人际敏感度低", "过度批判", "难以接受批评"],
                        careers: ["科学研究", "技术创新", "战略规划", "系统架构", "学术研究", "咨询"],
                        growthTips: [
                            "培养对他人情感的敏感度",
                            "学会与他人合作和妥协",
                            "提高沟通和表达能力",
                            "接受不同的观点和方法",
                            "发展情感智能"
                        ]
                    },
                    "ISFJ": {
                        name: "守卫者型",
                        subtitle: "忠诚、体贴、注重细节的保护者",
                        description: "ISFJ型人格忠诚、体贴，善于照顾他人的实际需求。他们注重细节和传统，能够创造稳定、有序的环境。他们具有强烈的责任感和同理心，是可靠的朋友和同事。在工作中，他们认真负责，能够提供细致的服务和支持。",
                        strengths: ["忠诚可靠", "体贴入微", "注重细节", "善于照顾他人", "责任心强"],
                        weaknesses: ["过度牺牲", "难以拒绝他人", "对变化抵抗", "自我价值感低", "难以表达负面情绪"],
                        careers: ["医疗护理", "教育", "行政助理", "社会工作", "客户服务", "图书馆工作"],
                        growthTips: [
                            "学会关注自己的需求",
                            "建立健康的边界",
                            "提高对变化的适应能力",
                            "发展自我肯定",
                            "学习表达不同意见"
                        ]
                    },
                    "INFJ": {
                        name: "提倡者型",
                        subtitle: "富有洞察力、理想主义的精神领袖",
                        description: "INFJ型人格富有洞察力和同理心，致力于实现自己的价值观和理想。他们善于理解他人的动机和情感，能够提供深度的情感支持和指导。他们具有强烈的直觉和创造性思维，常常能够看到问题的本质和解决方案。在工作中，他们追求有意义的贡献和个人成长。",
                        strengths: ["洞察力强", "富有同理心", "创造性思维", "理想主义", "善于倾听"],
                        weaknesses: ["过度理想化", "情感消耗过大", "难以面对冲突", "对批评敏感", "完美主义"],
                        careers: ["心理咨询", "教育", "写作", "艺术创作", "社会工作", "人力资源"],
                        growthTips: [
                            "学会设定现实的期望",
                            "建立健康的情感边界",
                            "提高面对冲突的能力",
                            "接受自己和他人的不完美",
                            "平衡理想和现实"
                        ]
                    },
                    "ESTP": {
                        name: "企业家型",
                        subtitle: "灵活、冒险、善于把握机会的行动者",
                        description: "ESTP型人格灵活、务实，善于在现实环境中把握机会。他们具有强烈的好奇心和冒险精神，喜欢尝试新事物和挑战。他们善于解决即时问题，在压力下表现出色。在社交场合，他们充满活力和魅力，能够轻松与人建立联系。",
                        strengths: ["灵活适应", "务实高效", "善于把握机会", "社交能力强", "应变能力"],
                        weaknesses: ["缺乏长远规划", "难以坚持长期目标", "冲动决策", "对规则缺乏尊重", "忽视细节"],
                        careers: ["销售", "创业", "市场营销", "娱乐业", "体育", "执法"],
                        growthTips: [
                            "培养长远规划能力",
                            "提高专注力和坚持度",
                            "在决策前更多思考",
                            "学会尊重规则和程序",
                            "关注重要细节"
                        ]
                    },
                    "ENTP": {
                        name: "辩论家型",
                        subtitle: "聪明、好奇、富有创意的思想家",
                        description: "ENTP型人格聪明、好奇，善于提出创新的想法和解决方案。他们具有卓越的分析能力和辩论技巧，喜欢挑战传统思维和假设。他们充满活力和幽默感，能够激发他人的思考和讨论。在工作中，他们善于识别机会和解决复杂问题。",
                        strengths: ["创新思维", "分析能力", "辩论技巧", "好奇心强", "善于沟通"],
                        weaknesses: ["缺乏专注", "难以完成项目", "过度批判", "忽视细节", "冲动决策"],
                        careers: ["创业", "咨询", "法律", "市场营销", "研发", "媒体"],
                        growthTips: [
                            "提高专注力和执行力",
                            "学会完成已开始的项目",
                            "培养对他人的敏感度",
                            "关注实施细节",
                            "在表达观点时更加谨慎"
                        ]
                    },
                    "ESFP": {
                        name: "表演者型",
                        subtitle: "热情、活泼、善于娱乐的社交达人",
                        description: "ESFP型人格热情、活泼，善于创造欢乐和轻松的氛围。他们注重当下的体验和感受，喜欢与人互动和分享。他们具有强烈的同理心和社交能力，能够轻松与人建立联系。在工作中，他们善于客户服务和团队合作，能够带来积极的能量。",
                        strengths: ["热情活泼", "社交能力强", "善于娱乐", "富有同理心", "适应能力"],
                        weaknesses: ["缺乏规划", "难以延迟满足", "对批评敏感", "注意力分散", "难以应对压力"],
                        careers: ["表演艺术", "客户服务", "销售", "活动策划", "旅游", "教育"],
                        growthTips: [
                            "培养规划和组织能力",
                            "提高延迟满足的能力",
                            "增强对批评的承受力",
                            "提高专注力",
                            "学习压力管理技巧"
                        ]
                    },
                    "ENFP": {
                        name: "竞选者型",
                        subtitle: "充满热情、富有创意的理想主义者",
                        description: "ENFP型人格充满热情和创意，善于发现可能性和机会。他们具有强烈的好奇心和探索精神，喜欢尝试新想法和体验。他们善于理解他人的情感和动机，能够建立深度的人际关系。在工作中，他们追求有意义的贡献和个人成长，善于激励他人。",
                        strengths: ["富有创意", "热情洋溢", "善于沟通", "富有同理心", "善于激励"],
                        weaknesses: ["缺乏专注", "难以做决定", "对批评敏感", "过度承诺", "缺乏结构"],
                        careers: ["市场营销", "公共关系", "教育", "咨询", "艺术创作", "创业"],
                        growthTips: [
                            "提高专注力和执行力",
                            "培养决策能力",
                            "增强对批评的承受力",
                            "学会合理承诺",
                            "发展组织和规划能力"
                        ]
                    },
                    "ISTP": {
                        name: "手艺人型",
                        subtitle: "冷静、务实、善于解决问题的实践者",
                        description: "ISTP型人格冷静、务实，善于分析和解决实际问题。他们具有强烈的好奇心和动手能力，喜欢探索事物的工作原理。他们独立自主，善于在压力下保持冷静和理性。在工作中，他们注重效率和实用性，能够找到简单有效的解决方案。",
                        strengths: ["务实高效", "善于解决问题", "动手能力强", "冷静理性", "独立自主"],
                        weaknesses: ["情感表达不足", "难以坚持长期目标", "对规则缺乏尊重", "社交能力弱", "缺乏规划"],
                        careers: ["工程", "技术维修", "科学研究", "执法", "军事", "户外运动"],
                        growthTips: [
                            "学习表达情感和赞赏",
                            "提高长期规划能力",
                            "学会尊重规则和程序",
                            "发展社交技能",
                            "培养组织能力"
                        ]
                    },
                    "INTP": {
                        name: "逻辑学家型",
                        subtitle: "理性、好奇、善于分析的思考者",
                        description: "INTP型人格理性、好奇，善于深入分析复杂问题。他们具有卓越的逻辑思维和抽象思考能力，喜欢探索理论和概念。他们独立自主，重视智力挑战和知识追求。在工作中，他们善于创新和解决复杂问题，常常在科学、技术和学术领域做出贡献。",
                        strengths: ["逻辑思维", "分析能力", "创新能力", "独立自主", "好奇心强"],
                        weaknesses: ["社交能力弱", "情感表达不足", "缺乏执行力", "对批评敏感", "完美主义"],
                        careers: ["科学研究", "软件开发", "学术研究", "系统分析", "工程设计", "哲学"],
                        growthTips: [
                            "发展社交和沟通技能",
                            "学习表达情感和赞赏",
                            "提高执行力和行动力",
                            "增强对批评的承受力",
                            "接受不完美和妥协"
                        ]
                    },
                    "ISFP": {
                        name: "探险家型",
                        subtitle: "敏感、灵活、注重个人体验的艺术家",
                        description: "ISFP型人格敏感、灵活，注重个人体验和情感表达。他们具有强烈的审美感和创造力，善于通过艺术和行动表达自己。他们独立自主，重视个人价值观和自由。在工作中，他们追求有意义的贡献和个人成长，善于在灵活的环境中发挥创意。",
                        strengths: ["富有创意", "敏感体贴", "灵活适应", "独立自主", "善于表达"],
                        weaknesses: ["对批评敏感", "难以做决定", "缺乏规划", "社交能力弱", "难以应对冲突"],
                        careers: ["艺术创作", "设计", "医疗护理", "教育", "社会工作", "环境保护"],
                        growthTips: [
                            "增强对批评的承受力",
                            "培养决策能力",
                            "发展规划和组织能力",
                            "提高社交技能",
                            "学习应对冲突的技巧"
                        ]
                    },
                    "INFP": {
                        name: "调停者型",
                        subtitle: "理想主义、敏感、富有同理心的思想家",
                        description: "INFP型人格理想主义、敏感，具有强烈的个人价值观和道德感。他们善于理解他人的情感和动机，能够提供深度的情感支持。他们具有丰富的想象力和创造力，喜欢探索意义和可能性。在工作中，他们追求有意义的贡献和个人成长，善于在和谐的环境中发挥创意。",
                        strengths: ["理想主义", "富有同理心", "创造性思维", "善于倾听", "价值观明确"],
                        weaknesses: ["对批评敏感", "难以面对冲突", "缺乏执行力", "过度理想化", "自我怀疑"],
                        careers: ["写作", "艺术创作", "心理咨询", "教育", "社会工作", "非营利组织"],
                        growthTips: [
                            "增强对批评的承受力",
                            "学习应对冲突的技巧",
                            "提高执行力和行动力",
                            "平衡理想和现实",
                            "建立自信和自我肯定"
                        ]
                    }
                }
            },
            big5: {
                name: "大五人格测试",
                description: "大五人格测试是心理学中最广泛使用的人格测量工具之一，通过五个核心维度来描述人格特质：开放性(Openness)、尽责性(Conscientiousness)、外向性(Extraversion)、宜人性(Agreeableness)和神经质(Neuroticism)。",
                questions: [
                    {
                        id: 1,
                        text: "我喜欢尝试新事物和新体验",
                        dimension: "O",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 2,
                        text: "我做事有条理，喜欢按计划行事",
                        dimension: "C",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 3,
                        text: "我在社交场合中感到自在和活跃",
                        dimension: "E",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 4,
                        text: "我关心他人的感受和需求",
                        dimension: "A",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 5,
                        text: "我容易感到焦虑或担忧",
                        dimension: "N",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 6,
                        text: "我对艺术和美学有浓厚的兴趣",
                        dimension: "O",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 7,
                        text: "我是一个可靠和负责任的人",
                        dimension: "C",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 8,
                        text: "我喜欢与他人交往和互动",
                        dimension: "E",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 9,
                        text: "我愿意帮助他人，即使没有回报",
                        dimension: "A",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 10,
                        text: "我的情绪波动较大",
                        dimension: "N",
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    }
                ],
                results: {
                    calculateType: function(scores) {
                        // 根据五个维度的得分确定主要特征
                        let type = "";
                        let maxScore = 0;
                        let maxDimension = "";
                        
                        for (const [dimension, score] of Object.entries(scores)) {
                            if (score > maxScore) {
                                maxScore = score;
                                maxDimension = dimension;
                            }
                        }
                        
                        switch(maxDimension) {
                            case "O":
                                type = scores.O > 3 ? "高开放性" : "低开放性";
                                break;
                            case "C":
                                type = scores.C > 3 ? "高尽责性" : "低尽责性";
                                break;
                            case "E":
                                type = scores.E > 3 ? "高外向性" : "低外向性";
                                break;
                            case "A":
                                type = scores.A > 3 ? "高宜人性" : "低宜人性";
                                break;
                            case "N":
                                type = scores.N > 3 ? "高神经质" : "低神经质";
                                break;
                        }
                        
                        return type;
                    },
                    generateResult: function(scores) {
                        const type = this.calculateType(scores);
                        
                        // 生成综合描述
                        let description = "";
                        let strengths = [];
                        let weaknesses = [];
                        let careers = [];
                        let growthTips = [];
                        
                        // 根据五个维度的得分生成描述
                        if (scores.O > 3) {
                            description += "你具有高度的开放性，对新经验和新想法持开放态度。你富有想象力和创造力，喜欢探索抽象概念和美学体验。";
                            strengths.push("富有创意", "好奇心强", "开放思维", "善于创新", "想象力丰富");
                            weaknesses.push("可能过于理想主义", "难以专注于细节", "对常规任务缺乏耐心");
                            careers.push("艺术", "设计", "研究", "创新", "教育");
                        } else {
                            description += "你倾向于实用和传统的思维方式，喜欢熟悉和具体的事物。你注重实际应用，善于处理日常事务。";
                            strengths.push("务实可靠", "注重细节", "善于执行", "稳定性强", "传统价值观");
                            weaknesses.push("可能抵制变化", "缺乏创新思维", "对抽象概念不感兴趣");
                            careers.push("管理", "行政", "技术", "财务", "生产");
                        }
                        
                        if (scores.C > 3) {
                            description += " 你具有高度的尽责性，做事有条理、可靠且自律。你善于规划和组织，能够坚持完成任务并追求卓越。";
                            strengths.push("有条理", "可靠", "自律", "目标导向", "注重质量");
                            weaknesses.push("可能过于完美主义", "难以放松", "对自己和他人要求过高");
                            careers.push("管理", "项目管理", "财务", "法律", "工程");
                        } else {
                            description += " 你更加灵活和随性，喜欢即兴发挥和适应变化。你可能不太喜欢严格的计划和规则，更注重当下的体验。";
                            strengths.push("灵活适应", "善于应变", "享受当下", "创造力强", "压力管理");
                            weaknesses.push("可能缺乏规划", "执行力不足", "难以坚持长期目标");
                            careers.push("创意", "销售", "娱乐", "创业", "咨询");
                        }
                        
                        if (scores.E > 3) {
                            description += " 你是一个外向的人，喜欢社交互动和活跃的环境。你充满活力，善于表达自己，享受与他人相处的时光。";
                            strengths.push("社交能力强", "充满活力", "善于表达", "自信", "领导力");
                            weaknesses.push("可能过于主导", "难以独处", "注意力分散");
                            careers.push("销售", "市场营销", "公共关系", "教育", "表演");
                        } else {
                            description += " 你更加内向和安静，喜欢独处或小范围的社交活动。你善于思考和反思，在安静的环境中工作效率更高。";
                            strengths.push("善于思考", "专注力强", "独立工作", "倾听能力", "自我反思");
                            weaknesses.push("可能社交焦虑", "难以表达自己", "团队合作挑战");
                            careers.push("研究", "写作", "技术", "设计", "分析");
                        }
                        
                        if (scores.A > 3) {
                            description += " 你具有高度的宜人性，关心他人的感受和需求。你友善、合作，愿意帮助他人，重视和谐的人际关系。";
                            strengths.push("友善", "富有同理心", "乐于助人", "合作精神", "道德感强");
                            weaknesses.push("可能过度牺牲", "难以拒绝", "冲突回避");
                            careers.push("医疗", "社会工作", "教育", "客户服务", "心理咨询");
                        } else {
                            description += " 你更加直接和竞争性，注重自己的需求和目标。你可能更加理性和客观，在需要时能够做出艰难的决定。";
                            strengths.push("直接坦率", "决策能力", "竞争力", "客观分析", "坚持己见");
                            weaknesses.push("可能过于直接", "缺乏同理心", "人际关系挑战");
                            careers.push("管理", "法律", "销售", "创业", "谈判");
                        }
                        
                        if (scores.N > 3) {
                            description += " 你可能更容易体验到负面情绪，如焦虑、担忧或压力。你的情绪反应较为敏感，但同时也可能更加富有洞察力和创造力。";
                            strengths.push("情感丰富", "洞察力强", "创造力", "自我意识", "直觉");
                            weaknesses.push("可能过度担忧", "情绪波动", "压力管理挑战");
                            growthTips.push("学习压力管理技巧", "培养积极思维", "建立健康的应对机制", "寻求社会支持", "实践正念和放松");
                        } else {
                            description += " 你通常情绪稳定，能够在压力下保持冷静。你很少感到焦虑或担忧，能够以平和的心态面对挑战。";
                            strengths.push("情绪稳定", "压力管理", "冷静理性", "自信", "适应能力");
                            weaknesses.push("可能情感表达不足", "忽视情绪需求", "缺乏紧迫感");
                            growthTips.push("学习识别和表达情感", "关注自己和他人的情绪需求", "培养同理心", "寻求情感连接", "实践自我关爱");
                        }
                        
                        // 生成成长建议
                        if (scores.O <= 3) {
                            growthTips.push("尝试新的体验和活动", "阅读不同类型的书籍", "探索艺术和文化", "练习创造性思维", "对新想法保持开放态度");
                        }
                        
                        if (scores.C <= 3) {
                            growthTips.push("制定明确的目标和计划", "培养时间管理技能", "提高组织能力", "建立日常习惯", "学习项目管理技巧");
                        }
                        
                        if (scores.E <= 3) {
                            growthTips.push("逐步扩大社交圈", "练习表达自己", "参加小组活动", "学习演讲技巧", "平衡独处和社交时间");
                        }
                        
                        if (scores.A <= 3) {
                            growthTips.push("练习同理心和倾听", "学习冲突解决技巧", "关注他人的需求", "参与合作项目", "培养感恩的心态");
                        }
                        
                        if (scores.N > 3) {
                            growthTips.push("学习压力管理技巧", "培养积极思维", "建立健康的应对机制", "寻求社会支持", "实践正念和放松");
                        }
                        
                        return {
                            type: type,
                            subtitle: `${scores.O > 3 ? 'O' : 'o'}${scores.C > 3 ? 'C' : 'c'}${scores.E > 3 ? 'E' : 'e'}${scores.A > 3 ? 'A' : 'a'}${scores.N > 3 ? 'N' : 'n'}`,
                            description: description,
                            strengths: strengths,
                            weaknesses: weaknesses,
                            careers: careers,
                            growthTips: growthTips
                        };
                    }
                }
            },
            enneagram: {
                name: "九型人格测试",
                description: "九型人格是一种古老的人格分类系统，描述了九种基本的人格类型，每种类型都有其独特的核心动机、恐惧和价值观。通过了解自己的九型人格类型，你可以更好地理解自己的行为模式和成长方向。",
                questions: [
                    {
                        id: 1,
                        text: "我对自己和他人都有较高的标准，希望事情能做到尽善尽美",
                        type: 1,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 2,
                        text: "我乐于主动关心他人的需求，愿意为他人提供帮助",
                        type: 2,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 3,
                        text: "我非常重视个人成就，希望通过努力获得他人的认可",
                        type: 3,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 4,
                        text: "我情感丰富细腻，容易被艺术、文学等富有美感的事物打动",
                        type: 4,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 5,
                        text: "我喜欢独处和思考，重视个人空间和知识的积累",
                        type: 5,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 6,
                        text: "我常常担心潜在的风险和问题，喜欢提前做好准备",
                        type: 6,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 7,
                        text: "我追求快乐和刺激，喜欢尝试新事物和新体验",
                        type: 7,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 8,
                        text: "我坚强自信，喜欢掌控局面，保护自己和他人",
                        type: 8,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    },
                    {
                        id: 9,
                        text: "我追求和谐与平静，避免冲突，喜欢与他人和平相处",
                        type: 9,
                        options: [
                            { text: "非常不符合", score: 1 },
                            { text: "较不符合", score: 2 },
                            { text: "一般", score: 3 },
                            { text: "较符合", score: 4 },
                            { text: "非常符合", score: 5 }
                        ]
                    }
                ],
                results: {
                    1: {
                        name: "完美主义者",
                        subtitle: "追求完美，重视原则和标准",
                        description: "你是一个理想主义者，对自己和他人都有很高的标准。你重视原则、正义和道德，努力做到最好。你善于分析和批判，能够发现问题并寻求改进。在工作中，你认真负责，注重细节，追求卓越。你相信通过努力和自律，可以创造一个更美好的世界。",
                        strengths: ["有原则", "负责任", "注重细节", "善于分析", "追求卓越"],
                        weaknesses: ["过度批判", "完美主义", "难以接受错误", "对自己和他人要求过高", "情感表达不足"],
                        careers: ["质量控制", "法律", "教育", "编辑", "咨询", "管理"],
                        growthTips: [
                            "学会接受不完美和错误",
                            "培养自我同情和接纳",
                            "放松对自己和他人的要求",
                            "学习表达情感和赞赏",
                            "在坚持原则的同时保持灵活性"
                        ]
                    },
                    2: {
                        name: "助人者",
                        subtitle: "热情友善，乐于帮助他人",
                        description: "你是一个热情、友善的人，善于关心和帮助他人。你重视人际关系，乐于满足他人的需求，希望被他人需要和喜爱。你具有强烈的同理心和情感智能，能够理解他人的感受和动机。在工作中，你善于团队合作，能够创造和谐的工作环境，为他人提供支持和鼓励。",
                        strengths: ["热情友善", "乐于助人", "富有同理心", "善于建立关系", "情感智能高"],
                        weaknesses: ["过度牺牲自我", "难以拒绝他人", "忽视自己的需求", "对批评敏感", "情感依赖"],
                        careers: ["教育", "医疗护理", "社会工作", "客户服务", "人力资源", "心理咨询"],
                        growthTips: [
                            "学会关注自己的需求",
                            "建立健康的边界",
                            "培养说'不'的能力",
                            "发展自我价值感",
                            "平衡给予和接受"
                        ]
                    },
                    3: {
                        name: "成就者",
                        subtitle: "目标导向，追求成功和认可",
                        description: "你是一个有野心、目标导向的人，善于设定目标并努力实现。你重视成就和成功，希望通过自己的努力获得他人的认可和赞赏。你具有强烈的竞争力和适应能力，能够在不同的环境中脱颖而出。在工作中，你高效、务实，善于抓住机会，追求卓越和进步。",
                        strengths: ["目标导向", "高效务实", "适应能力强", "有竞争力", "善于抓住机会"],
                        weaknesses: ["过度工作", "忽视个人感受", "难以面对失败", "过于关注形象", "缺乏深度连接"],
                        careers: ["销售", "市场营销", "管理", "创业", "表演艺术", "体育"],
                        growthTips: [
                            "学会放慢脚步，关注过程而非结果",
                            "培养对自己和他人的真实连接",
                            "接受失败和不完美",
                            "关注内在价值而非外部认可",
                            "平衡工作和生活"
                        ]
                    },
                    4: {
                        name: "浪漫主义者",
                        subtitle: "情感丰富，追求独特和意义",
                        description: "你是一个敏感、富有创造力的人，重视个人情感和内在体验。你追求独特性和深度，希望找到自己的真实身份和生命意义。你具有强烈的审美感和艺术天赋，善于表达情感和创造美。在工作中，你注重个人表达和创意，追求有意义的贡献和个人成长。",
                        strengths: ["创造力强", "情感丰富", "善于表达", "有洞察力", "追求意义"],
                        weaknesses: ["情绪波动", "过度敏感", "自我怀疑", "逃避现实", "人际关系挑战"],
                        careers: ["艺术创作", "写作", "设计", "音乐", "心理咨询", "教育"],
                        growthTips: [
                            "培养情绪稳定性",
                            "学习接纳自己和他人",
                            "建立现实感和行动力",
                            "发展健康的人际关系",
                            "在理想和现实之间找到平衡"
                        ]
                    },
                    5: {
                        name: "观察者",
                        subtitle: "理性思考，追求知识和独立",
                        description: "你是一个理性、好奇的思考者，重视知识和理解。你喜欢独处和反思，善于分析复杂问题和概念。你具有强烈的观察力和洞察力，能够看到事物的本质和模式。在工作中，你注重深度思考和专业能力，善于解决复杂问题，追求知识和真理。",
                        strengths: ["理性思考", "观察力强", "知识丰富", "善于分析", "独立自主"],
                        weaknesses: ["社交能力弱", "情感表达不足", "过度思考", "难以行动", "与现实脱节"],
                        careers: ["科学研究", "技术开发", "学术研究", "数据分析", "哲学", "写作"],
                        growthTips: [
                            "发展社交和情感表达能力",
                            "学会平衡思考和行动",
                            "增强与现实的连接",
                            "培养团队合作能力",
                            "关注自己和他人的情感需求"
                        ]
                    },
                    6: {
                        name: "忠诚者",
                        subtitle: "谨慎可靠，重视安全和归属感",
                        description: "你是一个谨慎、负责任的人，重视安全和稳定。你善于预见潜在的风险和问题，喜欢提前做好准备。你具有强烈的责任感和忠诚度，重视团队和家庭的归属感。在工作中，你可靠、细致，善于制定计划和遵循规则，能够为团队提供稳定和安全。",
                        strengths: ["谨慎可靠", "负责任", "善于规划", "忠诚", "团队合作"],
                        weaknesses: ["过度担忧", "缺乏自信", "难以做决定", "对变化抵抗", "权威挑战"],
                        careers: ["项目管理", "安全管理", "法律", "教育", "医疗", "社会工作"],
                        growthTips: [
                            "培养信任和自信",
                            "学习管理焦虑和担忧",
                            "提高决策能力",
                            "增强对变化的适应能力",
                            "发展内在的安全感"
                        ]
                    },
                    7: {
                        name: "享乐主义者",
                        subtitle: "乐观积极，追求快乐和多样性",
                        description: "你是一个乐观、充满活力的人，追求快乐和新体验。你善于发现生活中的美好和机会，喜欢尝试新事物和挑战。你具有强烈的好奇心和创造力，能够看到多种可能性和解决方案。在工作中，你充满创意和热情，善于激励他人，能够在变化的环境中保持积极和灵活。",
                        strengths: ["乐观积极", "创造力强", "充满活力", "适应能力强", "善于激励"],
                        weaknesses: ["缺乏专注", "难以面对负面情绪", "承诺困难", "冲动决策", "逃避责任"],
                        careers: ["市场营销", "创意设计", "娱乐业", "旅游", "创业", "教育"],
                        growthTips: [
                            "培养专注力和坚持度",
                            "学习面对和处理负面情绪",
                            "提高承诺和责任意识",
                            "在决策前更多思考",
                            "平衡即时满足和长期目标"
                        ]
                    },
                    8: {
                        name: "挑战者",
                        subtitle: "坚强自信，追求权力和正义",
                        description: "你是一个坚强、自信的领导者，喜欢掌控局面和保护他人。你具有强烈的正义感和勇气，敢于面对挑战和冲突。你善于做决定和采取行动，能够在压力下保持冷静和果断。在工作中，你具有领导力和影响力，能够激励团队实现目标，保护团队成员的利益。",
                        strengths: ["坚强自信", "领导力强", "正义感强", "果断决策", "保护他人"],
                        weaknesses: ["过于强势", "难以倾听", "控制欲强", "对脆弱不适应", "冲突倾向"],
                        careers: ["管理", "创业", "法律", "军事", "执法", "政治"],
                        growthTips: [
                            "学会倾听和理解他人",
                            "培养同理心和耐心",
                            "接受自己和他人的脆弱",
                            "发展合作而非控制的领导风格",
                            "在坚强的同时保持温柔"
                        ]
                    },
                    9: {
                        name: "和平主义者",
                        subtitle: "温和包容，追求和谐与平静",
                        description: "你是一个温和、包容的人，重视和谐与平静。你善于理解和接纳他人，避免冲突和对抗。你具有强烈的同理心和耐心，能够看到不同观点的价值。在工作中，你善于团队合作，能够创造和谐的工作环境，为团队提供稳定和平衡。",
                        strengths: ["温和包容", "善于倾听", "团队合作", "耐心", "接纳他人"],
                        weaknesses: ["难以表达自己", "缺乏主见", "拖延倾向", "忽视自己的需求", "难以做决定"],
                        careers: ["教育", "医疗", "社会工作", "咨询", "艺术", "环境保护"],
                        growthTips: [
                            "学会表达自己的想法和需求",
                            "培养主见和决策能力",
                            "提高行动力和紧迫感",
                            "关注自己的需求和价值",
                            "在和谐与真实之间找到平衡"
                        ]
                    }
                }
            }
        };

        // 应用状态
        let currentState = {
            currentPage: 'home',
            selectedTestType: null,
            currentTest: null,
            currentQuestionIndex: 0,
            userAnswers: [],
            testResults: null
        };

        // DOM 元素
        const pages = {
            home: document.getElementById('home-page'),
            instructions: document.getElementById('instructions-page'),
            test: document.getElementById('test-page'),
            result: document.getElementById('result-page')
        };

        // 导航函数
        function showPage(pageName) {
            // 隐藏所有页面
            Object.values(pages).forEach(page => {
                page.classList.add('hidden');
            });
            
            // 显示目标页面
            pages[pageName].classList.remove('hidden');
            currentState.currentPage = pageName;
        }

        // 加载测试说明
        function loadTestInstructions(testType) {
            const test = testData[testType];
            document.getElementById('test-title').textContent = test.name;
            document.getElementById('test-description').textContent = test.description;
            
            currentState.selectedTestType = testType;
            showPage('instructions');
        }

        // 开始测试
        function startTest() {
            const testType = currentState.selectedTestType;
            const test = testData[testType];
            
            currentState.currentTest = test;
            currentState.currentQuestionIndex = 0;
            currentState.userAnswers = Array(test.questions.length).fill(null);
            
            loadQuestion(0);
            showPage('test');
        }

        // 加载问题
        function loadQuestion(index) {
            const test = currentState.currentTest;
            const question = test.questions[index];
            
            document.getElementById('question-text').textContent = question.text;
            document.getElementById('current-question-number').textContent = index + 1;
            document.getElementById('total-questions').textContent = test.questions.length;
            
            // 更新进度条
            const progressPercentage = ((index + 1) / test.questions.length) * 100;
            document.getElementById('progress-fill').style.width = `${progressPercentage}%`;
            
            // 加载选项
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, optionIndex) => {
                const optionCard = document.createElement('div');
                optionCard.className = 'option-card p-4 border rounded-lg flex items-center';
                
                if (currentState.userAnswers[index] === optionIndex) {
                    optionCard.classList.add('selected');
                }
                
                optionCard.innerHTML = `
                    <input type="radio" name="question-${index}" class="radio-button mr-3" ${currentState.userAnswers[index] === optionIndex ? 'checked' : ''}>
                    <label class="flex-grow cursor-pointer">${option.text}</label>
                `;
                
                optionCard.addEventListener('click', () => {
                    // 移除其他选项的选中状态
                    document.querySelectorAll('.option-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    
                    // 添加当前选项的选中状态
                    optionCard.classList.add('selected');
                    
                    // 更新答案
                    currentState.userAnswers[index] = optionIndex;
                    
                    // 启用下一题按钮
                    document.getElementById('next-question-btn').disabled = false;
                });
                
                optionsContainer.appendChild(optionCard);
            });
            
            // 更新导航按钮状态
            document.getElementById('prev-question-btn').disabled = index === 0;
            document.getElementById('next-question-btn').disabled = currentState.userAnswers[index] === null;
        }

        // 下一题
        function nextQuestion() {
            const test = currentState.currentTest;
            currentState.currentQuestionIndex++;
            
            if (currentState.currentQuestionIndex < test.questions.length) {
                loadQuestion(currentState.currentQuestionIndex);
            } else {
                calculateResults();
            }
        }

        // 上一题
        function prevQuestion() {
            if (currentState.currentQuestionIndex > 0) {
                currentState.currentQuestionIndex--;
                loadQuestion(currentState.currentQuestionIndex);
            }
        }

        // 计算测试结果
        function calculateResults() {
            const testType = currentState.selectedTestType;
            const test = currentState.currentTest;
            let result = null;
            
            switch (testType) {
                case 'mbti':
                    result = calculateMBTIResults();
                    break;
                case 'big5':
                    result = calculateBig5Results();
                    break;
                case 'enneagram':
                    result = calculateEnneagramResults();
                    break;
            }
            
            currentState.testResults = result;
            displayResults(result);
            saveResultToHistory(result);
        }

        // 计算 MBTI 结果
        function calculateMBTIResults() {
            const scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            
            currentState.userAnswers.forEach((answerIndex, questionIndex) => {
                const question = currentState.currentTest.questions[questionIndex];
                const selectedOption = question.options[answerIndex];
                const score = selectedOption.score;
                
                scores[score]++;
            });
            
            // 确定每个维度的倾向
            const type = 
                (scores.E > scores.I ? 'E' : 'I') +
                (scores.S > scores.N ? 'S' : 'N') +
                (scores.T > scores.F ? 'T' : 'F') +
                (scores.J > scores.P ? 'J' : 'P');
            
            return {
                type: type,
                scores: scores,
                ...testData.mbti.results[type]
            };
        }

        // 计算大五人格结果
        function calculateBig5Results() {
            const scores = { O: 0, C: 0, E: 0, A: 0, N: 0 };
            
            currentState.userAnswers.forEach((answerIndex, questionIndex) => {
                const question = currentState.currentTest.questions[questionIndex];
                const selectedOption = question.options[answerIndex];
                const dimension = question.dimension;
                
                scores[dimension] += selectedOption.score;
            });
            
            // 计算平均分
            for (const dimension in scores) {
                const questionCount = currentState.currentTest.questions.filter(q => q.dimension === dimension).length;
                scores[dimension] = scores[dimension] / questionCount;
            }
            
            const result = testData.big5.results.generateResult(scores);
            return {
                type: result.type,
                subtitle: result.subtitle,
                scores: scores,
                description: result.description,
                strengths: result.strengths,
                weaknesses: result.weaknesses,
                careers: result.careers,
                growthTips: result.growthTips
            };
        }

        // 计算九型人格结果
        function calculateEnneagramResults() {
            const scores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0 };
            
            currentState.userAnswers.forEach((answerIndex, questionIndex) => {
                const question = currentState.currentTest.questions[questionIndex];
                const selectedOption = question.options[answerIndex];
                const type = question.type;
                
                scores[type] += selectedOption.score;
            });
            
            // 找出最高分的类型
            let maxScore = 0;
            let mainType = 1;
            
            for (const type in scores) {
                if (scores[type] > maxScore) {
                    maxScore = scores[type];
                    mainType = parseInt(type);
                }
            }
            
            const result = testData.enneagram.results[mainType];
            return {
                type: result.name,
                subtitle: result.subtitle,
                scores: scores,
                description: result.description,
                strengths: result.strengths,
                weaknesses: result.weaknesses,
                careers: result.careers,
                growthTips: result.growthTips
            };
        }

        // 显示结果
        function displayResults(result) {
            document.getElementById('result-title').textContent = result.type;
            document.getElementById('result-subtitle').textContent = result.subtitle;
            document.getElementById('personality-description').textContent = result.description;
            
            // 显示优势
            const strengthsList = document.getElementById('strengths-list');
            strengthsList.innerHTML = '';
            result.strengths.forEach(strength => {
                const li = document.createElement('li');
                li.className = 'flex items-center';
                li.innerHTML = `<i class="fa fa-check-circle text-success mr-2"></i> ${strength}`;
                strengthsList.appendChild(li);
            });
            
            // 显示劣势
            const weaknessesList = document.getElementById('weaknesses-list');
            weaknessesList.innerHTML = '';
            result.weaknesses.forEach(weakness => {
                const li = document.createElement('li');
                li.className = 'flex items-center';
                li.innerHTML = `<i class="fa fa-exclamation-circle text-warning mr-2"></i> ${weakness}`;
                weaknessesList.appendChild(li);
            });
            
            // 显示适合职业
            const careersContainer = document.getElementById('careers-container');
            careersContainer.innerHTML = '';
            result.careers.forEach(career => {
                const tag = document.createElement('span');
                tag.className = 'px-3 py-1 bg-primary bg-opacity-10 text-primary rounded-full text-sm';
                tag.textContent = career;
                careersContainer.appendChild(tag);
            });
            
            // 显示成长建议
            const growthTips = document.getElementById('growth-tips');
            growthTips.innerHTML = '';
            result.growthTips.forEach(tip => {
                const li = document.createElement('li');
                li.textContent = tip;
                growthTips.appendChild(li);
            });
            
            // 显示图表
            createResultChart(result);
            
            showPage('result');
        }

        // 创建结果图表
        function createResultChart(result) {
            const ctx = document.getElementById('result-chart').getContext('2d');
            
            // 根据测试类型创建不同的图表
            switch (currentState.selectedTestType) {
                case 'mbti':
                    createMBTIRadarChart(ctx, result);
                    break;
                case 'big5':
                    createBig5BarChart(ctx, result);
                    break;
                case 'enneagram':
                    createEnneagramPieChart(ctx, result);
                    break;
            }
        }

        // 创建 MBTI 雷达图
        function createMBTIRadarChart(ctx, result) {
            const scores = result.scores;
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['外向性(E)', '内向性(I)', '感觉(S)', '直觉(N)', '思考(T)', '情感(F)', '判断(J)', '感知(P)'],
                    datasets: [{
                        label: '得分',
                        data: [scores.E, scores.I, scores.S, scores.N, scores.T, scores.F, scores.J, scores.P],
                        backgroundColor: 'rgba(99, 102, 241, 0.2)',
                        borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(99, 102, 241, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(99, 102, 241, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: Math.max(...Object.values(scores)) + 1,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // 创建大五人格柱状图
        function createBig5BarChart(ctx, result) {
            const scores = result.scores;
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['开放性(O)', '尽责性(C)', '外向性(E)', '宜人性(A)', '神经质(N)'],
                    datasets: [{
                        label: '得分',
                        data: [scores.O, scores.C, scores.E, scores.A, scores.N],
                        backgroundColor: [
                            'rgba(99, 102, 241, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(236, 72, 153, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(245, 158, 11, 0.8)'
                        ],
                        borderColor: [
                            'rgba(99, 102, 241, 1)',
                            'rgba(139, 92, 246, 1)',
                            'rgba(236, 72, 153, 1)',
                            'rgba(239, 68, 68, 1)',
                            'rgba(245, 158, 11, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // 创建九型人格饼图
        function createEnneagramPieChart(ctx, result) {
            const scores = result.scores;
            
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['完美主义者(1)', '助人者(2)', '成就者(3)', '浪漫主义者(4)', '观察者(5)', '忠诚者(6)', '享乐主义者(7)', '挑战者(8)', '和平主义者(9)'],
                    datasets: [{
                        data: [scores[1], scores[2], scores[3], scores[4], scores[5], scores[6], scores[7], scores[8], scores[9]],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(99, 102, 241, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(236, 72, 153, 0.8)',
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(249, 115, 22, 0.8)',
                            'rgba(107, 114, 128, 0.8)'
                        ],
                        borderColor: [
                            'rgba(239, 68, 68, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(99, 102, 241, 1)',
                            'rgba(139, 92, 246, 1)',
                            'rgba(236, 72, 153, 1)',
                            'rgba(59, 130, 246, 1)',
                            'rgba(249, 115, 22, 1)',
                            'rgba(107, 114, 128, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12,
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        // 保存结果到历史记录
        function saveResultToHistory(result) {
            let history = JSON.parse(localStorage.getItem('personalityTestHistory') || '[]');
            
            const newRecord = {
                id: Date.now(),
                testType: currentState.selectedTestType,
                testName: currentState.currentTest.name,
                result: result,
                date: new Date().toISOString()
            };
            
            history.unshift(newRecord);
            localStorage.setItem('personalityTestHistory', JSON.stringify(history));
            
            loadHistory();
        }

        // 加载历史记录
        function loadHistory() {
            const historyList = document.getElementById('history-list');
            const history = JSON.parse(localStorage.getItem('personalityTestHistory') || '[]');
            
            if (history.length === 0) {
                historyList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fa fa-history text-4xl mb-3"></i>
                        <p>还没有测试记录</p>
                        <p class="text-sm mt-1">完成测试后，结果将显示在这里</p>
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = '';
            history.forEach(record => {
                const date = new Date(record.date);
                const formattedDate = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                
                const historyItem = document.createElement('div');
                historyItem.className = 'android-card p-4 cursor-pointer';
                historyItem.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="font-medium text-gray-800">${record.testName}</h4>
                            <p class="text-sm text-primary font-medium">${record.result.type}</p>
                            <p class="text-xs text-gray-500 mt-1">${formattedDate}</p>
                        </div>
                        <button class="text-gray-400 delete-history-btn" data-id="${record.id}">
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </div>
                `;
                
                historyItem.addEventListener('click', (e) => {
                    if (!e.target.closest('.delete-history-btn')) {
                        currentState.testResults = record.result;
                        currentState.selectedTestType = record.testType;
                        currentState.currentTest = testData[record.testType];
                        displayResults(record.result);
                    }
                });
                
                historyList.appendChild(historyItem);
            });
            
            // 添加删除按钮事件
            document.querySelectorAll('.delete-history-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const recordId = parseInt(btn.dataset.id);
                    deleteHistoryRecord(recordId);
                });
            });
        }

        // 删除历史记录
        function deleteHistoryRecord(recordId) {
            let history = JSON.parse(localStorage.getItem('personalityTestHistory') || '[]');
            history = history.filter(record => record.id !== recordId);
            localStorage.setItem('personalityTestHistory', JSON.stringify(history));
            loadHistory();
        }

        // 清空历史记录
        function clearHistory() {
            if (confirm('确定要清空所有测试历史吗？')) {
                localStorage.removeItem('personalityTestHistory');
                loadHistory();
            }
        }

        // 分享功能
        function showShareModal() {
            const result = currentState.testResults;
            
            document.getElementById('share-title').textContent = result.type;
            document.getElementById('share-subtitle').textContent = result.subtitle;
            
            // 创建分享图表
            const ctx = document.getElementById('share-chart').getContext('2d');
            
            switch (currentState.selectedTestType) {
                case 'mbti':
                    createMBTIRadarChart(ctx, result);
                    break;
                case 'big5':
                    createBig5BarChart(ctx, result);
                    break;
                case 'enneagram':
                    createEnneagramPieChart(ctx, result);
                    break;
            }
            
            document.getElementById('share-modal').classList.remove('hidden');
        }

        // 关闭分享弹窗
        function closeShareModal() {
            document.getElementById('share-modal').classList.add('hidden');
        }

        // 保存结果图片
        function saveResultImage() {
            const shareCard = document.getElementById('share-card-preview');
            
            // 使用 html2canvas 库将卡片转换为图片
            html2canvas(shareCard).then(canvas => {
                const link = document.createElement('a');
                link.download = `人格测试结果_${currentState.testResults.type}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // 事件监听器
        document.addEventListener('DOMContentLoaded', () => {
            // 测试类型选择
            document.querySelectorAll('[data-test-type]').forEach(card => {
                card.addEventListener('click', () => {
                    const testType = card.dataset.testType;
                    loadTestInstructions(testType);
                });
            });
            
            // 开始测试按钮
            document.getElementById('start-test-btn').addEventListener('click', startTest);
            
            // 返回按钮
            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showPage('home');
                });
            });
            
            // 返回首页按钮
            document.querySelectorAll('.back-to-home-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showPage('home');
                });
            });
            
            // 退出测试按钮
            document.getElementById('exit-test-btn').addEventListener('click', () => {
                if (confirm('确定要退出测试吗？当前进度将不会保存。')) {
                    showPage('home');
                }
            });
            
            // 下一题按钮
            document.getElementById('next-question-btn').addEventListener('click', nextQuestion);
            
            // 上一题按钮
            document.getElementById('prev-question-btn').addEventListener('click', prevQuestion);
            
            // 分享按钮
            document.getElementById('share-result-btn').addEventListener('click', showShareModal);
            
            // 关闭分享弹窗
            document.getElementById('close-share-modal').addEventListener('click', closeShareModal);
            
            // 保存图片按钮
            document.getElementById('save-image-btn').addEventListener('click', saveResultImage);
            
            // 保存结果按钮
            document.getElementById('save-result-btn').addEventListener('click', () => {
                alert('结果已保存到历史记录！');
            });
            
            // 再测一次按钮
            document.getElementById('take-another-test-btn').addEventListener('click', () => {
                showPage('home');
            });
            
            // 清空历史记录
            document.getElementById('clear-history').addEventListener('click', clearHistory);
            
            // 加载历史记录
            loadHistory();
        });
    </script>
</body>
</html>